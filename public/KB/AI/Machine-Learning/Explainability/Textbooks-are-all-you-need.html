<!DOCTYPE html>
<html lang="en"><head><title>Textbooks are all you need</title><meta charset="utf-8"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com"/><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=IBM Plex Mono&amp;family=Schibsted Grotesk:wght@400;700&amp;family=Source Sans Pro:ital,wght@0,400;0,600;1,400;1,600&amp;display=swap"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta property="og:title" content="Textbooks are all you need"/><meta property="og:description" content="Textbooks Are All You Need Summary : This paper proposes a new code assisting model that uses Python text books to train as textbooks have more curated knowledge ..."/><meta property="og:image" content="https://https://subhadityamukherjee.github.io/AI-knowledge-base//static/og-image.png"/><meta property="og:width" content="1200"/><meta property="og:height" content="675"/><link rel="icon" href="../../../../static/icon.png"/><meta name="description" content="Textbooks Are All You Need Summary : This paper proposes a new code assisting model that uses Python text books to train as textbooks have more curated knowledge ..."/><meta name="generator" content="Quartz"/><link href="../../../../index.css" rel="stylesheet" type="text/css" spa-preserve/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css" rel="stylesheet" type="text/css" spa-preserve/><script src="../../../../prescript.js" type="application/javascript" spa-preserve></script><script type="application/javascript" spa-preserve>const fetchData = fetch("../../../../static/contentIndex.json").then(data => data.json())</script></head><body data-slug="KB/AI/Machine-Learning/Explainability/Textbooks-are-all-you-need"><div id="quartz-root" class="page"><div id="quartz-body"><div class="left sidebar"><h2 class="page-title"><a href="../../../..">Subhaditya's KB</a></h2><div class="spacer mobile-only"></div><div class="search"><button class="search-button" id="search-button"><p>Search</p><svg role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title>Search</title><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"></path><circle cx="8" cy="8" r="7"></circle></g></svg></button><div id="search-container"><div id="search-space"><input autocomplete="off" id="search-bar" name="search" type="text" aria-label="Search for something" placeholder="Search for something"/><div id="search-layout" data-preview="true"></div></div></div></div><button class="darkmode" id="darkmode"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="dayIcon" x="0px" y="0px" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35" xml:space="preserve" aria-label="Dark mode"><title>Dark mode</title><path d="M6,17.5C6,16.672,5.328,16,4.5,16h-3C0.672,16,0,16.672,0,17.5    S0.672,19,1.5,19h3C5.328,19,6,18.328,6,17.5z M7.5,26c-0.414,0-0.789,0.168-1.061,0.439l-2,2C4.168,28.711,4,29.086,4,29.5    C4,30.328,4.671,31,5.5,31c0.414,0,0.789-0.168,1.06-0.44l2-2C8.832,28.289,9,27.914,9,27.5C9,26.672,8.329,26,7.5,26z M17.5,6    C18.329,6,19,5.328,19,4.5v-3C19,0.672,18.329,0,17.5,0S16,0.672,16,1.5v3C16,5.328,16.671,6,17.5,6z M27.5,9    c0.414,0,0.789-0.168,1.06-0.439l2-2C30.832,6.289,31,5.914,31,5.5C31,4.672,30.329,4,29.5,4c-0.414,0-0.789,0.168-1.061,0.44    l-2,2C26.168,6.711,26,7.086,26,7.5C26,8.328,26.671,9,27.5,9z M6.439,8.561C6.711,8.832,7.086,9,7.5,9C8.328,9,9,8.328,9,7.5    c0-0.414-0.168-0.789-0.439-1.061l-2-2C6.289,4.168,5.914,4,5.5,4C4.672,4,4,4.672,4,5.5c0,0.414,0.168,0.789,0.439,1.06    L6.439,8.561z M33.5,16h-3c-0.828,0-1.5,0.672-1.5,1.5s0.672,1.5,1.5,1.5h3c0.828,0,1.5-0.672,1.5-1.5S34.328,16,33.5,16z     M28.561,26.439C28.289,26.168,27.914,26,27.5,26c-0.828,0-1.5,0.672-1.5,1.5c0,0.414,0.168,0.789,0.439,1.06l2,2    C28.711,30.832,29.086,31,29.5,31c0.828,0,1.5-0.672,1.5-1.5c0-0.414-0.168-0.789-0.439-1.061L28.561,26.439z M17.5,29    c-0.829,0-1.5,0.672-1.5,1.5v3c0,0.828,0.671,1.5,1.5,1.5s1.5-0.672,1.5-1.5v-3C19,29.672,18.329,29,17.5,29z M17.5,7    C11.71,7,7,11.71,7,17.5S11.71,28,17.5,28S28,23.29,28,17.5S23.29,7,17.5,7z M17.5,25c-4.136,0-7.5-3.364-7.5-7.5    c0-4.136,3.364-7.5,7.5-7.5c4.136,0,7.5,3.364,7.5,7.5C25,21.636,21.636,25,17.5,25z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="nightIcon" x="0px" y="0px" viewBox="0 0 100 100" style="enable-background:new 0 0 100 100" xml:space="preserve" aria-label="Light mode"><title>Light mode</title><path d="M96.76,66.458c-0.853-0.852-2.15-1.064-3.23-0.534c-6.063,2.991-12.858,4.571-19.655,4.571  C62.022,70.495,50.88,65.88,42.5,57.5C29.043,44.043,25.658,23.536,34.076,6.47c0.532-1.08,0.318-2.379-0.534-3.23  c-0.851-0.852-2.15-1.064-3.23-0.534c-4.918,2.427-9.375,5.619-13.246,9.491c-9.447,9.447-14.65,22.008-14.65,35.369  c0,13.36,5.203,25.921,14.65,35.368s22.008,14.65,35.368,14.65c13.361,0,25.921-5.203,35.369-14.65  c3.872-3.871,7.064-8.328,9.491-13.246C97.826,68.608,97.611,67.309,96.76,66.458z"></path></svg></button></div><div class="center"><div class="page-header"><div class="popover-hint"><nav class="breadcrumb-container" aria-label="breadcrumbs"><div class="breadcrumb-element"><a href="../../../../">Home</a><p> ❯ </p></div><div class="breadcrumb-element"><a href="../../../../KB/">KB</a><p> ❯ </p></div><div class="breadcrumb-element"><a href="../../../../KB/AI/">AI</a><p> ❯ </p></div><div class="breadcrumb-element"><a href="../../../../KB/AI/Machine-Learning/">Machine Learning</a><p> ❯ </p></div><div class="breadcrumb-element"><a href="../../../../KB/AI/Machine-Learning/Explainability/">Explainability</a><p> ❯ </p></div><div class="breadcrumb-element"><a href>Textbooks are all you need</a></div></nav><h1 class="article-title">Textbooks are all you need</h1><p show-comma="true" class="content-meta"><span>Sep 18, 2024</span><span>9 min read</span></p></div></div><article class="popover-hint"><h1 id="textbooks-are-all-you-need">Textbooks Are All You Need<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#textbooks-are-all-you-need" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h1>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="toc" data-theme="github-light github-dark"><code data-language="toc" data-theme="github-light github-dark" style="display:grid;"><span data-line> </span></code></pre></figure>
<ul>
<li><em>Summary</em> : This paper proposes a new code assisting model that uses Python text books to train as textbooks have more curated knowledge. There are quite a few limitations such as not learning, maths and being specific to the type of textbooks used.</li>
</ul>
<h2 id="abstract">Abstract<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#abstract" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<ul>
<li>phi-1</li>
<li>new large language model for code,</li>
<li>significantly smaller size than competing models:</li>
<li>Transformer-based model with 1.3B parameters, trained for 4 days on 8 A100s, using a selection of “textbook quality” data from the web (6B tokens)</li>
<li>synthetically generated textbooks and exercises with GPT-3.5</li>
<li>surprising emergent properties compared to phi-1-base, our model before our finetuning stage on a dataset of coding exercises, and phi-1-small, a smaller model with 350M parameters trained with the same pipeline as phi-1 that still achieves 45% on HumanEval.</li>
<li><img src="../../../../images/img_p1_1.png" alt/></li>
</ul>
<h2 id="training-details-and-the-importance-of-high-quality-data">Training Details and the Importance of High-quality Data<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#training-details-and-the-importance-of-high-quality-data" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<ul>
<li><img src="../../../../images/img_p1_2.png" alt/></li>
<li>
<h1 id="the-central-ingredient-our-model-relies-on-textbook-quality-training-data">the central ingredient our model relies on textbook-quality training data.<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#the-central-ingredient-our-model-relies-on-textbook-quality-training-data" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h1>
</li>
<li>training data. Unli+ke previous work that used standard sources of text data for code generation, such as The Stack [KLA 22] (which contains sourcecode from repositor+ies with permissive licenses) and other not optimal for teaching the model how to reason and plan algorithmically.</li>
<li>The standard code datasets [KLA+22, LCC+22] form a large and diverse corpus covering broad range of topics and use cases.</li>
<li>sufer from several drawbacks:</li>
<li>samples are not self-contained, meaning that they depend on other modules or files that are external to the snippet, making them hard to understand without additional context.</li>
<li>Typical examples do not involve any meaningful computation, but rather consist of trivial or boilerplate code, such as defining constants, setting parameters, or configuring GUI element</li>
<li>Samples that do contain algorithmic logic are often buried inside complex or poorly documented functions, making them dicult to follow or learn from.</li>
<li>examples are skewed towards certain topics or use cases, resulting in an unbalanced distribution of coding concepts and skills across the dataset.</li>
<li>language models would benefit from a training set that has the same qualities as what a human would perceive as a good “textbook”: it should be clear, self-contained, instructive, and balanced.</li>
<li>three main datasets:</li>
<li>filtered code-language dataset</li>
<li>subset of The Stack and StackOverflow, obtained by using a language model-based classifier (consisting of about 6B tokens).</li>
<li>synthetic textbook dataset</li>
<li>&lt;1B tokens of GPT-3.5 generated Python textbooks.</li>
<li>small synthetic exercises dataset</li>
<li>∼180M tokens of Python exercises and solutions.</li>
<li>s of Python exercises and solutions. contain less than 7B tokens</li>
<li>CodeTextbook</li>
</ul>
<h2 id="filtering-of-existing-code-datasets-using-a-transformer-based-classifier">Filtering of Existing Code Datasets Using a Transformer-based Classifier<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#filtering-of-existing-code-datasets-using-a-transformer-based-classifier" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<ul>
<li>Python subset of the deduplicated version of The Stack and the StackOverflow, which together contain over 35 million files/samples, totalling over 35B tokens.</li>
<li>annotate the quality of a small subset of these files (about 100k samples) using GPT- 4: given a code snippet, the model is prompted to “determine its educational value for a student whose goal is to learn basic coding concepts”.</li>
<li>use this annotated dataset to train a random forest classifier that predicts the quality of a file/sample using its output embedding from a pretrained codegen model as features.</li>
<li>unlike GPT-3.5, which we use extensively to generate synthetic content (discussed below), we use GPT-4 minimally only for annotations on the quality of a small subset of The Stack and StackOverflow</li>
<li><img src="../../../../images/img_p4_1.png" alt/></li>
</ul>
<h2 id="creation-of-synthetic-textbook-quality-datasets">Creation of Synthetic Textbook-quality Datasets<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#creation-of-synthetic-textbook-quality-datasets" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<ul>
<li>main challenges in creating a high-quality dataset for code generation is ensuring that the examples are diverse and non-repetitive.</li>
<li>the examples should cover a wide range of coding concepts, skills, and scenarios, and that they should vary in their level of diculty, complexity, and style.</li>
<li>exposes the language model to diferent ways of expressing and solving problems in code, it reduces the risk of overfitting or memorizing specific patterns or solutions, and it increases the generalization and robustness of the model to unseen or novel tasks</li>
<li>not trivial, especially when using synthetic data generated by another language model.</li>
<li>Simply prompting the model to produce a coding textbook or a set of exercises, even with some variation in the instructions or the parameters, will likely result in a very homogeneous and redundant dataset, where the same concepts and solutions are repeated over and over with minor changes.</li>
<li>language models tend to follow the most probable or common paths given their training data and their priors, and they lack the creativity or the incentive to explore alternative or novel ways of generating code.</li>
<li>one needs to find the right “trick”</li>
<li>The synthetic textbook dataset</li>
<li>diversity is obtained by providing constraints on topics and target audience of the generated textbook</li>
<li><img src="../../../../images/img_p5_1.png" alt/></li>
<li>The CodeExercises dataset</li>
<li>conduct explicit decontamination and alternative evaluations in the following sections to ensure that problems similar to those from HumanEval benchmark are not seen during finetuning.</li>
<li><img src="../../../../images/img_p6_1.png" alt/></li>
</ul>
<h2 id="model-architecture-and-training">Model Architecture and Training<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#model-architecture-and-training" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<ul>
<li>some recent models like CodeGen [NPH+22], PaLM [CND+22], and GPT-NeoX [BBH+22]. The architecture for our 1.3B parameter phi-1 model consists of 24 layers, hidden dimension of 2048, MLP-inner dimension of 8192, and 32 attention heads of dimension 64 each. The smaller 350M parameter phi- 1-small model consists of 20 layers, hidden dimension of 1024, MLP-inner dimension+of 4096, and 16 attention heads of dimension 64 each. We also use a rotary position+embedding [SLP 21] with rotary</li>
<li>could further boost performance and eciency [LAZ 23].</li>
<li>For both pretraining and finetuning, we concatenate our respective datasets into a single dimensional</li>
<li>array with</li>
<li>array with “��endoftext��” token used for separating the files. We train our models on sequence length of optimizer, linear-warmup-linear-decay learning rate schedule, and attention and residual dropout of 0.1.</li>
<li>Pretraining</li>
<li>phi-1-base was trained on the CodeTextbook dataset</li>
<li>phi-1 is obtained by finetuning phi-1-base on the CodeExercises dataset.</li>
</ul>
<h2 id="spikes-of-model-capability-after-finetuning-on-codeexercises">Spikes of Model Capability after Finetuning on CodeExercises<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#spikes-of-model-capability-after-finetuning-on-codeexercises" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<ul>
<li>the model after finetuning also exhibits a substantial improvement in executing tasks that are not featured in the finetuning dataset.</li>
<li>This includes managing intricate algorithmic tasks and using external libraries.</li>
<li>suggests that our finetuning process might have helped the model in reorganizing and consolidating the knowledge acquired during pretraining, even if such knowledge is not explicitly present in our CodeExercises dataset</li>
<li>Finetuning improves the model’s understanding</li>
<li>Finetuning improves the model’s ability to use external libraries</li>
</ul>
<h2 id="evaluation-on-unconventional-problems-with-llm-grading">Evaluation on Unconventional Problems with LLM Grading<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#evaluation-on-unconventional-problems-with-llm-grading" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<ul>
<li>A potential concern with the surprisingly good performance of phi-1 on HumanEval (see Table 1 and Figure 2.1) is that there might be memorization stemming from contamination of the CodeExercises dataset1</li>
<li>To minimize bias and leakage, the new evaluation problems were created by a dedicated team in our group that did not access the CodeExercises dataset or the final model.</li>
<li>They created 50 new problems in the same format as HumanEval with instructions to design problems that are unlikely to appear in real-world code bases or as coding exercises.</li>
<li>To evaluate candidate solutions, we therefore adopt the approach of using GPT-4 to grade the solution</li>
<li>This approach has two distinct advantages: (1) by using GPT-4 as a grader, we can leverage its knowledge and generative abilities to obtain a more fine-grained and meaningful signal of the student model’s coding capabilities, and (2) it obviates the need for tests</li>
<li>Our prompt instructs the LLM to evaluate a student’s solution first in a short verbal evaluation followed by grades from 0 to 10</li>
</ul>
<h2 id="data-pruning-for-unbiased-performance-evaluation">Data Pruning for Unbiased Performance Evaluation<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#data-pruning-for-unbiased-performance-evaluation" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<ul>
<li>training on CodeExercises leads to a substantial boost in the performance of the model on the HumanEval benchmark</li>
<li>To investigate this boost, we propose to prune the CodeExercises dataset by removing files that are “similar” to those in HumanEval.</li>
<li>“strong form” of data decontamination.</li>
<li>retrain our model on such pruned data, and still observe strong performance on HumanEval.</li>
<li>such data pruning experiment is a fair way to evaluate performance</li>
</ul>
<h2 id="n-gram-overlap">N-gram Overlap<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#n-gram-overlap" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<ul>
<li>N-gram measures the similarity of text segments based on the shared n-word sequences.</li>
<li>n-gram overlap between the docstrings of each humaneval question and each exercise in the CodeExercises dataset that was generated</li>
<li>found 4 humaneval questions with 13-gram overlap with at least one of the entries in our dataset</li>
<li>all the 4 overlap cases in the 13-gram are all false positives such as the example # below.</li>
<li>Our n-gram overlap analysis shows that our dataset has minimal letter-by-letter overlap with HumanEval.</li>
</ul>
<h2 id="embedding-and-syntax-based-similarity-analysis">Embedding and Syntax-based Similarity Analysis<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#embedding-and-syntax-based-similarity-analysis" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<ul>
<li>now turn to the pruning experiments</li>
<li>n-gram analysis is not refined enough to find similar code snippets between HumanEval and CodeExercises</li>
<li>combination of embedding and syntax-based distances.</li>
<li>For the embedding distance we compute the L2 distance</li>
<li>between the embedding of+the code snippets where the embedding is derived from a pre-trained CodeGenMono 350M model [NPH 23].</li>
<li>For the syntax-based distance we calculate the (string) edit distance between the abstract syntax trees (ASTs) of two given code snippets.</li>
<li><img src="../../../../images/img_p9_1.png" alt/></li>
</ul>
<h2 id="conclusion">Conclusion<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#conclusion" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<ul>
<li>Just as a comprehensive, well-crafted textbook can provide a student with the necessary knowledge to master a new subject, our work demonstrates the remarkable impact of high-quality data in honing a language model’s proficiency in code- generation tasks.</li>
<li>By crafting “textbook quality” data we were able to train a model that surpasses almost all open-source models on coding benchmarks such as HumanEval and MBPP despite being 10x smaller in model size and 100x smaller in dataset size.</li>
<li>phi-1 is specialized in Python coding</li>
<li>phi-1 lacks the domain-specific knowledge of larger models such as programming with specific APIs or using less common packages.</li>
<li>due to the structured nature of the datasets and the lack of diversity in terms of language and style, phi-1 is less robust to stylistic variations or errors in the</li>
</ul>
<h2 id="limitation-of-phi-1">Limitation of Phi-1<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#limitation-of-phi-1" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<ul>
<li>Our model is sensitive to various perturbations of prompts.</li>
<li>First, its performance drops significantly as the length of the prompt increases, as it tends to ignore, forget or misinterpret parts of the prompt when it is too long</li>
<li>phi-1 demonstrates less robustness in handling natural language compared to ChatGPT or StarCoder, particularly with ambiguous prompts.</li>
<li>This may be because we filter out certain types of data from the training process to guarantee textbook-level quality.</li>
<li>A primary constraint of our model, particularly when contrasted with alternatives like StarCoder, lies in its performance on tasks involving counting and spatial reasoning</li>
</ul></article><hr/><div class="page-footer"></div></div><div class="right sidebar"><div class="graph"><h3>Graph View</h3><div class="graph-outer"><div id="graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:1,&quot;scale&quot;:1.1,&quot;repelForce&quot;:0.5,&quot;centerForce&quot;:0.3,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1,&quot;showTags&quot;:true,&quot;removeTags&quot;:[],&quot;focusOnHover&quot;:false}"></div><button id="global-graph-icon" aria-label="Global Graph"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 55 55" fill="currentColor" xml:space="preserve"><path d="M49,0c-3.309,0-6,2.691-6,6c0,1.035,0.263,2.009,0.726,2.86l-9.829,9.829C32.542,17.634,30.846,17,29,17
                s-3.542,0.634-4.898,1.688l-7.669-7.669C16.785,10.424,17,9.74,17,9c0-2.206-1.794-4-4-4S9,6.794,9,9s1.794,4,4,4
                c0.74,0,1.424-0.215,2.019-0.567l7.669,7.669C21.634,21.458,21,23.154,21,25s0.634,3.542,1.688,4.897L10.024,42.562
                C8.958,41.595,7.549,41,6,41c-3.309,0-6,2.691-6,6s2.691,6,6,6s6-2.691,6-6c0-1.035-0.263-2.009-0.726-2.86l12.829-12.829
                c1.106,0.86,2.44,1.436,3.898,1.619v10.16c-2.833,0.478-5,2.942-5,5.91c0,3.309,2.691,6,6,6s6-2.691,6-6c0-2.967-2.167-5.431-5-5.91
                v-10.16c1.458-0.183,2.792-0.759,3.898-1.619l7.669,7.669C41.215,39.576,41,40.26,41,41c0,2.206,1.794,4,4,4s4-1.794,4-4
                s-1.794-4-4-4c-0.74,0-1.424,0.215-2.019,0.567l-7.669-7.669C36.366,28.542,37,26.846,37,25s-0.634-3.542-1.688-4.897l9.665-9.665
                C46.042,11.405,47.451,12,49,12c3.309,0,6-2.691,6-6S52.309,0,49,0z M11,9c0-1.103,0.897-2,2-2s2,0.897,2,2s-0.897,2-2,2
                S11,10.103,11,9z M6,51c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S8.206,51,6,51z M33,49c0,2.206-1.794,4-4,4s-4-1.794-4-4
                s1.794-4,4-4S33,46.794,33,49z M29,31c-3.309,0-6-2.691-6-6s2.691-6,6-6s6,2.691,6,6S32.309,31,29,31z M47,41c0,1.103-0.897,2-2,2
                s-2-0.897-2-2s0.897-2,2-2S47,39.897,47,41z M49,10c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S51.206,10,49,10z"></path></svg></button></div><div id="global-graph-outer"><div id="global-graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:-1,&quot;scale&quot;:0.9,&quot;repelForce&quot;:0.5,&quot;centerForce&quot;:0.3,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1,&quot;showTags&quot;:true,&quot;removeTags&quot;:[],&quot;focusOnHover&quot;:true}"></div></div></div><div class="toc desktop-only"><button type="button" id="toc" class aria-controls="toc-content" aria-expanded="true"><h3>Table of Contents</h3><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="fold"><polyline points="6 9 12 15 18 9"></polyline></svg></button><div id="toc-content" class><ul class="overflow"><li class="depth-0"><a href="#textbooks-are-all-you-need" data-for="textbooks-are-all-you-need">Textbooks Are All You Need</a></li><li class="depth-1"><a href="#abstract" data-for="abstract">Abstract</a></li><li class="depth-1"><a href="#training-details-and-the-importance-of-high-quality-data" data-for="training-details-and-the-importance-of-high-quality-data">Training Details and the Importance of High-quality Data</a></li><li class="depth-0"><a href="#the-central-ingredient-our-model-relies-on-textbook-quality-training-data" data-for="the-central-ingredient-our-model-relies-on-textbook-quality-training-data">the central ingredient our model relies on textbook-quality training data.</a></li><li class="depth-1"><a href="#filtering-of-existing-code-datasets-using-a-transformer-based-classifier" data-for="filtering-of-existing-code-datasets-using-a-transformer-based-classifier">Filtering of Existing Code Datasets Using a Transformer-based Classifier</a></li><li class="depth-1"><a href="#creation-of-synthetic-textbook-quality-datasets" data-for="creation-of-synthetic-textbook-quality-datasets">Creation of Synthetic Textbook-quality Datasets</a></li><li class="depth-1"><a href="#model-architecture-and-training" data-for="model-architecture-and-training">Model Architecture and Training</a></li><li class="depth-1"><a href="#spikes-of-model-capability-after-finetuning-on-codeexercises" data-for="spikes-of-model-capability-after-finetuning-on-codeexercises">Spikes of Model Capability after Finetuning on CodeExercises</a></li><li class="depth-1"><a href="#evaluation-on-unconventional-problems-with-llm-grading" data-for="evaluation-on-unconventional-problems-with-llm-grading">Evaluation on Unconventional Problems with LLM Grading</a></li><li class="depth-1"><a href="#data-pruning-for-unbiased-performance-evaluation" data-for="data-pruning-for-unbiased-performance-evaluation">Data Pruning for Unbiased Performance Evaluation</a></li><li class="depth-1"><a href="#n-gram-overlap" data-for="n-gram-overlap">N-gram Overlap</a></li><li class="depth-1"><a href="#embedding-and-syntax-based-similarity-analysis" data-for="embedding-and-syntax-based-similarity-analysis">Embedding and Syntax-based Similarity Analysis</a></li><li class="depth-1"><a href="#conclusion" data-for="conclusion">Conclusion</a></li><li class="depth-1"><a href="#limitation-of-phi-1" data-for="limitation-of-phi-1">Limitation of Phi-1</a></li></ul></div></div><div class="backlinks"><h3>Backlinks</h3><ul class="overflow"><li><a href="../../../../KB/AI/Machine-Learning/Explainability/_Index_of_Explainability" class="internal">_Index_of_Explainability</a></li></ul></div></div></div><footer class><p>Created with <a href="https://quartz.jzhao.xyz/">Quartz v4.3.1</a> © 2025</p><ul><li><a href="https://github.com/SubhadityaMukherjee/AI-knowledge-base/">GitHub</a></li></ul></footer></div></body><script type="application/javascript">function c(){let t=this.parentElement;t.classList.toggle("is-collapsed");let l=t.classList.contains("is-collapsed")?this.scrollHeight:t.scrollHeight;t.style.maxHeight=l+"px";let o=t,e=t.parentElement;for(;e;){if(!e.classList.contains("callout"))return;let n=e.classList.contains("is-collapsed")?e.scrollHeight:e.scrollHeight+o.scrollHeight;e.style.maxHeight=n+"px",o=e,e=e.parentElement}}function i(){let t=document.getElementsByClassName("callout is-collapsible");for(let s of t){let l=s.firstElementChild;if(l){l.addEventListener("click",c),window.addCleanup(()=>l.removeEventListener("click",c));let e=s.classList.contains("is-collapsed")?l.scrollHeight:s.scrollHeight;s.style.maxHeight=e+"px"}}}document.addEventListener("nav",i);window.addEventListener("resize",i);
</script><script type="module">
          let mermaidImport = undefined
          document.addEventListener('nav', async () => {
            if (document.querySelector("code.mermaid")) {
              mermaidImport ||= await import('https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.7.0/mermaid.esm.min.mjs')
              const mermaid = mermaidImport.default
              const darkMode = document.documentElement.getAttribute('saved-theme') === 'dark'
              mermaid.initialize({
                startOnLoad: false,
                securityLevel: 'loose',
                theme: darkMode ? 'dark' : 'default'
              })

              await mermaid.run({
                querySelector: '.mermaid'
              })
            }
          });
          </script><script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/contrib/copy-tex.min.js" type="application/javascript"></script><script type="application/javascript">
        const socket = new WebSocket('ws://localhost:3001')
        // reload(true) ensures resources like images and scripts are fetched again in firefox
        socket.addEventListener('message', () => document.location.reload(true))
      </script><script src="../../../../postscript.js" type="module"></script></html>