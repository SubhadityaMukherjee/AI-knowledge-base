<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.53">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Ai_for_startups – Subhaditya’s KB</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../../styles.css">
</head>

<body class="nav-sidebar floating nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Subhaditya’s KB</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Ai_for_startups</li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Ai_for_startups</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">article</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<p><a href="https://www.linkedin.com/pulse/hitchhikers-guide-ai-startups-subhaditya-mukherjee/">AI For startup</a> #ai</p>
<section id="hitchhikers-guide-to-ai-for-startups" class="level1">
<h1>Hitchhikers Guide to AI for Startups</h1>
<p>Are you part of a startup, or want to start one? Want to have AI superpowers but don’t know where to start? Want to make sure you don’t sink your boat before it floats? Make sure you hire the right people and avoid blowing your budget out of the water. This article is for you. A helpful guide on what to focus on, resources you need, and punching common myths in the face. Sounds interesting? Read on.</p>
<p>(This is a long article. Skip to what you need. But if you are just starting, I would recommend reading the whole thing. Take your time. Take notes. Drop me an email with your questions. <a href="mailto:msubhaditya@gmail.com" class="email">msubhaditya@gmail.com</a>)</p>
<p>Okay, now, DONT PANIC.</p>
<section id="a-definition" class="level2">
<h2 class="anchored" data-anchor-id="a-definition">A definition</h2>
<p>Before we move on, let us first define what we mean by AI. Of course, there are quite a few definitions but for our purposes, we can define it as “any means of injecting a form of semi-automated intelligence that either performs a task previously impossible for computers or does a task as good as/better/faster than a human. An AI is used to learn how to perform a task, and can be thought of as a more advanced software.” Note for AI experts: The term AI is used in the article as a general word, interchangeably with deep learning, neural networks, etc. Yes, technically this is inaccurate. But this is an article for people with not much in the way of experience.</p>
<section id="some-useful-terms-you-might-need" class="level3">
<h3 class="anchored" data-anchor-id="some-useful-terms-you-might-need">Some useful terms you might need</h3>
<ul>
<li>AI model/architecture: The brain that makes up an AI</li>
<li>GPU: A specialized computing unit that accelerates intensive computation, like training an AI</li>
<li>Neural Networks: Inspired by the brain, what makes “AI” tick</li>
<li>Latency: How long does your model take to give results</li>
<li>SOTA: State of the Art. What is the best model for the task, right now?</li>
<li>Training: The process where the AI learns how to perform a task</li>
<li>Inference: Using a trained AI to predict some results</li>
<li>Cluster: A group of computers used to parallelly perform a task</li>
</ul>
</section>
</section>
<section id="a-little-index" class="level2">
<h2 class="anchored" data-anchor-id="a-little-index">A little index</h2>
<p>This article is divided into three major sections. - If you want to dive into this field for the first time, or find ways to inject some AI into your companies, the first section is for you. - If you already have an AI startup, and are looking for ways to improve your infrastructure so you can grow, the second section is for you. - The third section talks about some of the pitfalls that one might face when they first dive into this space. Take it as a word of caution.</p>
</section>
<section id="section-1---the-beginning-stages-or-how-should-i-care-about-ai" class="level2">
<h2 class="anchored" data-anchor-id="section-1---the-beginning-stages-or-how-should-i-care-about-ai">Section 1 - The beginning stages Or How should I care about “AI”?</h2>
<section id="cutting-through-the-hype" class="level3">
<h3 class="anchored" data-anchor-id="cutting-through-the-hype">Cutting through the hype</h3>
<ul>
<li>Unrealistic expectations At the end of the day, AI is not a magic mushroom. It cannot solve everything you want, and neither can it evolve and take over the planet. Yet. Can you use it for your needs? Undoubtedly. So what can it do? It can categorize images, translate text, understand what it hears, recognize tumors, and anything your creativity allows. The key is to set realistic expectations. Think of it this way, if you can get a team of experts to do the task, then it might be possible to have an AI do it (Terms and conditions apply). Ask an AI consultant, or if you cannot afford one, look at this website [insert paperswithcode] for a list of tasks that are possible. If nothing else, it can give an idea of what can be done. Sometimes it might be possible for your idea to work in the long run, but it might just take more time and resources than you imagined. Only an expert would be able to tell you if it is a feasible plan. Expecting your developers to come up with something impossible is great, but only if you can afford it. For example, instead of trying to make an “AI that will take humans to Mars”, break it down into smaller tasks - “AI that recognizes space debris” + “AI that would identify system faults” + “AI that might predict what a type of rock found was” + … etc</li>
<li>Data requirements It is a myth that to “train” an AI, you need massive amounts of data. Yes, technically you do. But recently, there has been a lot of research conducted on “transfer learning”, which is a technology that allows you to start with an AI trained on large amounts of data, and fine-tune it to your specific use case. This is very helpful, especially if you are working on tasks similar to those that exist. For instance, if you want to train an AI to recognize different types of cars, this might not need a massive amount of data, because similar “recognition” tasks exist. But if you want to classify a hundred types of new tumors, that might require a little more data.</li>
<li>Extreme requirements The Tech giants want everyone to think that we need extreme computing power for our AI needs. But in reality, most companies can start with minimal requirements. Even if you cannot afford huge computing clusters or lots of computers, you can use online services to run the code. There are quite a few such services that provide “GPUs” (special computing units that accelerate running compute-intensive code). They charge you a fee by the hour, which is often quite cheaper, even at scale. As long as you have skilled workers, decent computers, and funds to support it. A word of warning, AI is still an experimental field. If your staff does not deliver, it would serve to try and understand if the task handed to them is realistic, or needs more resources. An AI expert/consultant would be helpful here.</li>
</ul>
</section>
<section id="so-you-want-to-be-an-ai-startup" class="level3">
<h3 class="anchored" data-anchor-id="so-you-want-to-be-an-ai-startup">So you want to be an AI startup?</h3>
<ul>
<li>Is AI needed? The rush to say “We use AI in our products to do XYZ” is very intense. Do not fall into peer pressure. It serves to first understand and identify where you need AI. Does a specific part of the infrastructure need to be revamped? Is there something you want to do that just normal programming cannot handle? Have you tried other options first? AI is expensive in the long run. Can you afford the staff? Pay for the time taken to research? Test some ideas, you might be able to hire a freelancer to make some mockups before diving in headfirst.</li>
<li>AI products vs AI as part of your existing infrastructure You might not need to fully use AI, maybe only some parts of your idea need it. If you are a new startup, please note that just AI will not be the end of all. Even if your idea is a pure AI product, there are quite a few software engineering components in it as well. It serves to understand the pipeline before starting, just so you do not fall into common traps and end up wasting time and money.</li>
<li>Domain knowledge Does your product revolve around a specific domain? Hire/Consult an expert. You will suffer badly otherwise. Yes, an AI model will give you results. But you will have no way of knowing how well they do. Just having numbers is not enough. In return, this will help you make even better software.</li>
<li>Survey Understanding your customer base is even more important here. The better you understand the requirements, the better you can make use of AI. The more you can flesh out your ideas, the more specific you can get with your software.</li>
<li>Competition Who is your competition? Do you have the time to revamp your software? Everyone wants AI these days. Some companies can spend millions on it, while others can’t. If you are in a field that has cutthroat technology developments, just starting up might be harder for you if you cannot afford it. If you are a new startup, try to focus on fields that need solutions but do not have larger corporations working on them. Domain expertise is great here.</li>
<li>Using products from Google/Microsoft/Amazon You will find every big company these days offering AI support. Should you use them? In my opinion, these are useful if you are planning on performing a very common task. If you have a domain-specific idea, making your own is probably the better bet. But do not hesitate to make use of the resources that they offer. Google Colab, Amazon AWS, and Microsoft Azure are great services. Using them, especially at the start, is a good idea. They could be a cheaper way of testing out your ideas.</li>
</ul>
<p>Remember, AI is a tool. Not a complete product.</p>
</section>
</section>
<section id="section-2---the-mid-stages-or-how-can-i-make-sure-i-make-my-best-ai" class="level2">
<h2 class="anchored" data-anchor-id="section-2---the-mid-stages-or-how-can-i-make-sure-i-make-my-best-ai">Section 2 - The mid stages ,Or, How can I make sure I make my best “AI”?</h2>
<section id="focus" class="level3">
<h3 class="anchored" data-anchor-id="focus">Focus</h3>
<p>Being an AI startup, you have a lot of things to look out for. Some of the main focus points to keep in mind are as follows. - Clear goals of what you want to achieve With any endeavor, knowing exactly what you want is imperative. More so in fields where testing takes up quite a lot of time and money. The better and more fine-grained your explanation, the better your results. - Clear expectations on what is possible within a time frame I repeat, AI is a research field. Just because Google can make a huge product in a matter of months, does not guarantee you can too. An expert can help you set more realistic goals. You can, of course, try it out on your own, but only if you have the time and the risk appetite for the same. - Easy of use Make sure your service is easy to use. Using AI will suddenly show you how many knobs and switches you need to control. Do not overwhelm your poor users. Specific research in understanding what your customer wants is essential. - Multiple large platforms Scaling up is probably not a major concern for you right now. If it is though, make sure you can afford it. If you can’t, see if you can outsource it, or use an online service. Perhaps also consider other ways of optimizing your workflow. - Quick, rough tests Before you work on a final product, try out some small ideas. Hire freelancers if you do not have full-time staff on hand. Try out different models with any data you have on hand. Making sure you have a good baseline will save you quite some headache later on. - Validation testing By this point, you might have heard me say “test your ideas” quite a lot. But again, test your models. Use new data, use crappy data. Does it still work? If not, keep working.</p>
</section>
<section id="people" class="level3">
<h3 class="anchored" data-anchor-id="people">People</h3>
<p>Aside from being able to build AI models, you also need people who would be able to support the infrastructure. Make sure you have domain experts you can call on. Also find people who would be able to deploy the model onto a chosen service, and can maintain them. Of course, the usual requirements of making an interface, servers, etc still stay based on the type of project you have in mind. Budget and requirements play a key role here and are specific to your idea and scale.</p>
</section>
</section>
<section id="section-3---a-word-of-caution-how-can-i-make-sure-my-boat-does-not-sink" class="level2">
<h2 class="anchored" data-anchor-id="section-3---a-word-of-caution-how-can-i-make-sure-my-boat-does-not-sink">Section 3 - A word of caution How can I make sure my boat does not sink?</h2>
<section id="capacity" class="level3">
<h3 class="anchored" data-anchor-id="capacity">Capacity</h3>
<p>Oh? So you made an AI model? Congratulations. Now you need to get your users on board. Regardless of if you have an app, a website, or a device, make sure you can estimate how many users you will have. AI models tend to take more resources than classical computer software. Identify how long your model takes to get results. Will your users be fine with that? Do you need more resources to ensure faster outputs? Will they be able to reliably access your service? Test, test, test. There are quite a few optimizations possible. It is beyond the scope of this article, but you can drop me an email if you want to know more.</p>
</section>
<section id="model-drift" class="level3">
<h3 class="anchored" data-anchor-id="model-drift">Model drift</h3>
<p>Over time, how good your results are will drift. This might be because the data your model learned differs from the model it is getting now. For example, in a fashion-related product, the trend of clothing changes over time. Using an old model that has not seen new data will not be great. Periodically checking for a spike in errors, and retraining the model on new data is essential. Make sure your employees know how to do that.</p>
</section>
<section id="bias-and-ethical-concerns" class="level3">
<h3 class="anchored" data-anchor-id="bias-and-ethical-concerns">Bias and ethical concerns</h3>
<p>If you teach a kid that colored people are evil, that’s what they will learn. Similarly, an AI model can learn mistaken assumptions. The larger the data, the more such assumptions are automatically made. Identifying these would help you understand if your product would have unintended consequences. The more variation you can provide to your model, the better in the long run. Make sure your data is inclusive. Especially if it contains hints of the biases of age, gender, ethnicity, etc. Test for these biases specifically. Make sure that you can explain if your model goes wrong and does something stupid. There is a great course on how to do this <a href="https://www.fast.ai/2020/08/19/data-ethics/">Ethics for AI</a> by Rachel Thomas from <a href="https://www.fast.ai">fast.ai</a>.</p>
</section>
</section>
<section id="fin" class="level2">
<h2 class="anchored" data-anchor-id="fin">Fin</h2>
<p>So, will you use AI, or will AI use you Feel free to reach out or leave your comments. Email: <a href="mailto:msubhaditya@gmail.com" class="email">msubhaditya@gmail.com</a></p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>