<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.53">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>The Behavior of Tutoring Systems – Subhaditya’s KB</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-sidebar floating nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Subhaditya’s KB</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">The Behavior of Tutoring Systems</li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">The Behavior of Tutoring Systems</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">usermodellearning</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="the-behavior-of-tutoring-systems" class="level1">
<h1>The Behavior of Tutoring Systems</h1>
<ul>
<li>Kurt VanLehn</li>
</ul>
<pre class="toc"><code></code></pre>
<section id="intro" class="level2">
<h2 class="anchored" data-anchor-id="intro">Intro</h2>
<ul>
<li>Tutoring systems are described as having two loops.</li>
<li>The outer loop executes once for each task, where a task usually consists of solving a complex, multi-step problem</li>
<li>The inner loop executes once for each step taken by the student in the solution of a task. The inner loop can give feedback and hints on each step. The inner loop can also assess the student’s evolving competence and update a student model, which is used by the outer loop to select a next task that is appropriate for the student.</li>
<li>A task usually takes several minutes to an hour or so. Most tutors assume that the student is working alone on a task, but some (e.g., Zachary et al., 1999) have the student work as one member of a multi-student team.</li>
<li>The tasks and the tutor’s user interface are usually designed so that completing a task requires multiple steps, where a step is a user interface action that the student takes in order to achieve a task.</li>
<li>Let us use knowledge for the information possessed by students that determines their behavior on task. Let us also assume that knowledge can be decomposed, and let us use the term <a href="../../posts/KB/Knowledge Component.html">Knowledge Component</a> for the units into which it is decomposed.</li>
<li><a href="../../posts/KB/Knowledge Component.html">Knowledge Component</a></li>
<li><a href="../../posts/KB/Learning Event.html">Learning Event</a></li>
<li><a href="../../posts/KB/Modeling Transfer.html">Modeling Transfer</a></li>
<li><a href="../../posts/KB/Predicting Student learning Curve.html">Predicting Student learning Curve</a></li>
<li><a href="../../posts/KB/Tutor.html">Tutor</a></li>
</ul>
</section>
<section id="the-outer-loop" class="level2">
<h2 class="anchored" data-anchor-id="the-outer-loop">THE OUTER LOOP</h2>
<ul>
<li>The main responsibility of the outer loop is to decide which task the student should do next. Its other responsibilities, such as presenting the task to the student, are more mundane and will not be mentioned again. The main design issues are (1) selecting a task intelligently and (2) obtaining a rich set of tasks to select from.</li>
</ul>
<section id="task-selection" class="level3">
<h3 class="anchored" data-anchor-id="task-selection">Task Selection</h3>
<ul>
<li>The outer loop displays a menu and lets the student select the next task.</li>
<li>The outer loop assigns tasks in a fixed sequence</li>
<li><a href="../../posts/KB/Mastery learning.html">Mastery learning</a></li>
<li><a href="../../posts/KB/Macroadaptation.html">Macroadaptation</a></li>
<li>In addition to selecting a task, some tutoring systems also select a mode for the task. For instance, <a href="../../posts/KB/Steve.html">Steve</a> can either (1) demonstrate how to do the task by taking each step itself and explaining it, or (2) hint each step before the student attempts it, or (3) let the student try to solve the task without such unsolicited hints.</li>
<li>In addition to providing some kind of mechanism for selecting tasks, the designer must provide a set of tasks for the outer loop to select from. It is often surprising how many problems are necessary in order to field a tutoring system. For a 13 week semester at 10 problems per week, the tutoring system needs 130 problems at minimum</li>
<li>Ideally, the tutor can generate its own tasks when given a specification of the desired characteristics.</li>
<li>For instance, given a specification of a <a href="../../posts/KB/Knowledge Component.html">Knowledge Component</a> to be taught, the SQL- Tutor (Martin &amp; Mitrovic, 2002) generates a database query, written in SQL, that involves the <a href="../../posts/KB/Knowledge Component.html">Knowledge Component</a>. A human author then writes text for a problem that has this database query as its solution. Using this technique, a human author was able to create 200 problems in about 3 hours— enough for a 6 week instructional module in an SQL course. Such programs are called problem generators.</li>
</ul>
</section>
</section>
<section id="the-inner-loop" class="level2">
<h2 class="anchored" data-anchor-id="the-inner-loop">THE INNER LOOP</h2>
<ul>
<li>Whereas the outer loop is about tasks, the inner loop is about steps within a task</li>
</ul>
<section id="minimal-feedback" class="level3">
<h3 class="anchored" data-anchor-id="minimal-feedback">MINIMAL FEEDBACK</h3>
<ul>
<li>Minimal feedback usually indicates whether a step is correct or incorrect, although other categories are sometimes used as well.</li>
</ul>
<section id="categories-of-minimal-feedback" class="level4">
<h4 class="anchored" data-anchor-id="categories-of-minimal-feedback">Categories of Minimal Feedback</h4>
<ul>
<li>Although most tutoring systems use just two categories, correct and incorrect, it is possible to use others.</li>
<li>Suppose a step is not part of an ideal solution to the problem, but it might be part of a non-ideal solution. The instructors might wish to consider this as a third category for minimal feedback—correct but non-optimal</li>
<li>For instance, when students solve physics problems on <a href="../../posts/KB/Andes.html">Andes</a>, they can enter an equation that is true of the given physical situation but is not necessary for solving the problem.</li>
<li>If instructors sometimes disagree on what makes for the best solution to the problem, it might be wise to subcategorize non-optimal. For instance, because some <a href="../../posts/KB/Sherlock.html">Sherlock</a> instructors emphasize reducing time and others emphasize reducing costs, <a href="../../posts/KB/Sherlock.html">Sherlock</a> could subcategorize non-optimal steps as wastes time or wastes parts. In short, the categories used for minimal feedback should reflect the pedagogical policies of the instructors.</li>
<li>If a step cannot be classified as into one of the minimal feedback categories (correct, incorrect, non-optimal, etc.), then it lands in an unrecognizable classification.</li>
<li>There are basically just three ways to treat such unrecognizable steps. (1) Some tutoring systems, such as the <a href="../../posts/KB/Algebra Cognitive Tutor.html">Algebra Cognitive Tutor</a>, assume that they can recognize all correct steps, so they treat unrecognizable steps as incorrect. (2) Other tutoring systems, such as the <a href="../../posts/KB/SQL-Tutor.html">SQL-Tutor</a>, assume that students will sometimes produce novel, correct solutions, so they treat unrecognized steps as correct. (3) Lastly, the tutoring system could simply tell the student that the step is unrecognizable. In this case, unrecognizable is yet another category for minimal feedback. When to give minimal feedback</li>
<li>Immediate feedback: <a href="../../posts/KB/Andes.html">Andes</a>, <a href="../../posts/KB/Algebra Cognitive Tutor.html">Algebra Cognitive Tutor</a>, <a href="../../posts/KB/Steve.html">Steve</a> and <a href="../../posts/KB/AutoTutor.html">AutoTutor</a> give feedback immediately after each student step. They vary considerably in how the feedback is presented.</li>
<li>Delayed feedback: Only if the step violates a safety regulation will <a href="../../posts/KB/Sherlock.html">Sherlock</a> give immediate feedback as the student solves a problem. However, after the problem is solved, the student can request a reviewing mode where minimal feedback is given. In particular, as <a href="../../posts/KB/Sherlock.html">Sherlock</a> replays the student’s solution step-by-step, it indicates which steps did not contribute any diagnostic information.</li>
<li>Demand feedback: The <a href="../../posts/KB/SQL-Tutor.html">SQL-Tutor</a> gives feedback only when the student clicks on the Submit button. Because the student can continue working on their solution after receiving such feedback, this does not count as delayed feedback.</li>
<li>The feedback policy can be a function of the student’s competence. For instance, if the student is nearing mastery, then the feedback is delayed whereas a less competent student would be given the same task with immediate feedback</li>
<li>This policy has been observed in human tutoring, and is one instance of fading the scaffolding, (Collins et al., 1989), because feedback is a kind of scaffolding (pedagogically useful help).</li>
</ul>
</section>
</section>
<section id="next-step-hints" class="level3">
<h3 class="anchored" data-anchor-id="next-step-hints">NEXT-STEP HINTS</h3>
<ul>
<li><ol type="1">
<li>When should the tutor give a hint about the next step? Should it wait for the student to ask? Should it give unsolicited hints when it detects guessing or floundering? 2. What step should the tutor suggest? For instance, if there are multiple paths to a solution, and the student appears to be following a long complex one, should the tutor suggest starting over? 3. How can the tutor give hints that maximize learning, keep frustration under control, and allow the student to finish the problem?</li>
</ol></li>
<li>The common wisdom is that a tutor should give a hint on the next step only if the student really needs it. If the student can enter a correct step by thinking hard enough, then the system should refuse to give a hint even if the student asks for one</li>
<li>On the other hand, if the student is likely to waste time and get frustrated by trying in vain to enter a correct step, or if the student is making repeated guesses instead of trying to figure out the next step, then the tutoring system should probably give a hint even if the student doesn’t ask for one.</li>
<li><a href="../../posts/KB/DT Tutor.html">DT Tutor</a></li>
<li><a href="../../posts/KB/Help Abuse.html">Help Abuse</a></li>
<li><a href="../../posts/KB/Help Refusal.html">Help Refusal</a></li>
</ul>
<section id="which-step-to-hint" class="level4">
<h4 class="anchored" data-anchor-id="which-step-to-hint">Which Step to Hint</h4>
<ul>
<li>The step must be correct.</li>
<li>The hinted step should not have been done already by the student.</li>
<li>Instructors’ preferences should be honored.</li>
<li>If the student has a plan for solving the problem or even for just the next step, then the tutor should hint the step that the student is trying to complete.</li>
<li>A somewhat more complex case occurs when the student has just made an incorrect step and received minimal negative feedback.</li>
<li>In AI, this is called the <a href="../../posts/KB/plan recognition problem.html">plan recognition problem</a></li>
</ul>
</section>
<section id="how-to-hint-the-next-step" class="level4">
<h4 class="anchored" data-anchor-id="how-to-hint-the-next-step">How to Hint the Next Step</h4>
<ul>
<li>Perhaps the most common policy is to construct a short sequence of hints for the next step.</li>
<li>The first hints are weak—they divulge little information so that students are encouraged to do most of the thinking themselves. Later hints are stronger.</li>
<li>If the step requires only one <a href="../../posts/KB/Knowledge Component.html">Knowledge Component</a>, then a standard hint sequence is Point, Teach and Bottom-out (Hume, Michael, Rovick, &amp; Evens, 1996)</li>
<li>Pointing hints mention problem conditions that should remind the student of the <a href="../../posts/KB/Knowledge Component.html">Knowledge Component</a>’s relevance.</li>
<li>Teaching hints describe the <a href="../../posts/KB/Knowledge Component.html">Knowledge Component</a> briefly and show how to apply it.</li>
<li>Bottom-out hints tell the student the step</li>
</ul>
</section>
</section>
<section id="error-specific-feedback" class="level3">
<h3 class="anchored" data-anchor-id="error-specific-feedback">ERROR-SPECIFIC FEEDBACK</h3>
<ul>
<li>The service consists of analyzing an incorrect step in order to determine the incorrect <a href="../../posts/KB/Learning Event.html">Learning Event</a>(s) that led to it, then giving instruction that is aimed at preventing that incorrect <a href="../../posts/KB/Learning Event.html">Learning Event</a>(s) from occurring again</li>
<li>There are many techniques for diagnosing errors. Most require that authors observe student errors, figure out what is causing a common error, write an appropriate error type for it, and implement some way to recognize such errors.</li>
<li>FOIL: First, Outer, Inner and Last</li>
</ul>
<section id="how-to-give-error-specific-feedback" class="level4">
<h4 class="anchored" data-anchor-id="how-to-give-error-specific-feedback">How to Give Error-specific Feedback</h4>
<ul>
<li>The main purpose of error-specific feedback is to get the student to change their knowledge so that they will not make this mistake again</li>
<li>Correcting one’s knowledge is sometimes compared to debugging a piece of software (Ohlsson, 1996). A programmer must first find evidence that the bug exists, then find out what the bug is, and then fix the bug. When tutees are not working with a tutor, they must do the whole self-debugging process themselves. They must first notice that a step is incorrect, then find the flaw in their reasoning and knowledge, then figure out what the correct learning events and knowledge components should be</li>
<li>Many tutors present feedback as a sequence of hints that are loosely associated with the stages of self-debugging. When the student enters an incorrect step, the tutor begins the sequence by simply giving minimal feedback. This is like providing the student with evidence of a knowledge bug but giving no further help toward identifying the bug or correcting it.</li>
</ul>
</section>
<section id="when-to-give-error-specific-feedback" class="level4">
<h4 class="anchored" data-anchor-id="when-to-give-error-specific-feedback">When to Give Error-specific Feedback</h4>
<ul>
<li>Students sometimes make careless errors, called slips in psychology (Norman, 1981), but fail to notice that they have made them, which can cause them to waste time looking for deep, potential misconceptions.</li>
<li>To ameliorate into slips and potential this, <a href="../../posts/KB/Andes.html">Andes</a> divides error misunderstandings. types</li>
<li>Slips are often made by the experts, including the instructors.</li>
<li>A potential misunderstanding is an error type that could be due to many factors, including incorrect beliefs, but it is almost never seen in expert’s work</li>
<li>When a student enters an incorrect step that is classified as a slip, then <a href="../../posts/KB/Andes.html">Andes</a> gives the error specific remediation immediately, e.g., You forgot to include a unit on a number. If the error is classified as a potential misunderstanding, then <a href="../../posts/KB/Andes.html">Andes</a> merely turns the incorrect step red, and lets the student ask for an error-specific hint if they want one.</li>
<li>Some student steps contain two or more errors. In order to keep the communication simple, the tutoring system should probably respond to only one of them. Students typically fix that error only, so the tutoring system can then mention the second error</li>
</ul>
</section>
</section>
</section>
<section id="what-kind-of-assessment-is-required" class="level2">
<h2 class="anchored" data-anchor-id="what-kind-of-assessment-is-required">What Kind of Assessment is Required?</h2>
<ul>
<li>A fundamental issue is the grain-size or granularity of the assessment.</li>
<li>The granularity of an assessment refers to the degree of aggregation over the task domain’s knowledge. An assessment is fine-grained if it provides, for instance, a probability of mastery for each <a href="../../posts/KB/Knowledge Component.html">Knowledge Component</a> in the task domain. An assessment is coarse-grained if it provides a single number that indicates the student’s overall competence.</li>
<li>Assessments are decision aids, and as a general heuristic, the bigger the decision, the coarser the required assessment. If a decision affects a whole semester, e.g., whether the student needs to retake a</li>
<li>required course, then the assessment should cover the whole semester and lead ultimately to a yes-no decision, so a single number per student is appropriate.</li>
<li>If a decision affects only, say, whether the tutor starts at the beginning of a hint sequence or in the middle, then only a small part of a fine-grained assessment is relevant</li>
<li>The general idea is that if the decision is small, in that it affects only a small amount of instructional time, then only a small amount of the domain’s knowledge can be accessed during that time and thus the relevant decision aid is the student’s competence on just that knowledge.</li>
<li>Tutors make many small decisions, so they are the main customers for fine-grained assessments.</li>
<li><a href="../../posts/KB/Coarse-grained assessment.html">Coarse-grained assessment</a></li>
<li><a href="../../posts/KB/Fine Grained assesment.html">Fine Grained assesment</a></li>
</ul>
<section id="issues-with-assesment" class="level3">
<h3 class="anchored" data-anchor-id="issues-with-assesment">Issues with Assesment</h3>
<ul>
<li>There are many other issues involved with assessment. Here are a few:</li>
<li>There is a big difference between little evidence and mixed evidence. If one merely takes the frequency of success relative to opportunities, then 0.5 can mean both 1 success and 1 failure (little evidence) or 20 successes and 20 failures (mixed evidence).</li>
<li>Students should be learning, so their knowledge should be changing. When should old evidence be ignored?</li>
<li>Should help given by the tutoring system be counted as evidence of learning or of lack of knowledge?</li>
<li>Are all learning events equally difficult? If not, then item response theory (<a href="../../posts/KB/IRT.html">IRT</a>) can be used so that success on easy learning events provides less evidence of competence than success on difficult learning events.</li>
<li>If the tutoring system includes error-specific feedback based on error types, should it somehow include the frequency of occurrence of the error types in its assessments?</li>
<li>Prior probabilities of mastery are not independent. If a student has not mastered a <a href="../../posts/KB/Knowledge Component.html">Knowledge Component</a> that is taught early in the course, then it is less likely that the student has mastered.</li>
<li>Knowledge components that appear later.</li>
</ul>
</section>
</section>
<section id="examples-of-tutoring-systems" class="level2">
<h2 class="anchored" data-anchor-id="examples-of-tutoring-systems">Examples of Tutoring Systems</h2>
<ul>
<li><a href="../../posts/KB/Steve.html">Steve</a></li>
<li><a href="../../posts/KB/Algebra Cognitive Tutor.html">Algebra Cognitive Tutor</a></li>
<li><a href="../../posts/KB/Andes.html">Andes</a></li>
<li><a href="../../posts/KB/Sherlock.html">Sherlock</a></li>
<li><a href="../../posts/KB/AutoTutor.html">AutoTutor</a></li>
<li><a href="../../posts/KB/SQL-Tutor.html">SQL-Tutor</a></li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>